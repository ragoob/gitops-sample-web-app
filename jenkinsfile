pipeline {
  agent any
  environment {
    WORKSPACE = pwd()
  }

  stages {
      stage('unit-test') {
      agent { docker { image 'golang' } }
      steps {
        echo 'Unit test excuting'
        def root = tool name: 'Go 1.20', type: 'go'
        withEnv(["GOROOT=${root}", "PATH+GO=${root}/bin", "GOBIN=${root}/bin", "GOPATH=${root}/go"]) {
          sh 'make unit-tests'
        }
      }
      }
  }
}
