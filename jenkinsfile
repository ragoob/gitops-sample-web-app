pipeline {
  agent any
  environment {
    WORKSPACE = pwd()
    GOPATH = "${JENKINS_HOME}/jobs/${JOB_NAME}/builds/${BUILD_ID}"

  }

  stages {
      stage('unit-test') {
      agent { docker { image 'golang' } }
      steps {
        echo 'Unit test excuting'
        withEnv(["GOPATH=${GOPATH}"]) {
          sh 'make unit-tests'
        }
      }
      }
  }
}
